# 纪律性指数 (Discipline Index - DI) 设计文档

## 1. 设计理念

传统的 K/D 或 Rating 侧重于结果（击杀数），而“纪律性”侧重于**过程的合理性**。一个高纪律性的选手应该：
*   **拒绝白给**：在非必要时刻不进行高风险单打。
*   **协同作战**：时刻处于能与队友形成补枪（Trade）的位置。
*   **资源管理**：合理使用道具，不带着满身道具死亡；经济起落与团队同步。
*   **减少失误**：避免对队友造成负面影响（如白队友）。

## 2. 核心维度

我们通过以下四个维度来量化纪律性：

### A. 协同维度 (Synergy) - 权重 40%
衡量选手是否“独狼”。
*   **指标：有效补枪率 (Trade Efficiency)**
    *   定义：`(完成补枪数 + 被补枪数) / 总死亡数`
    *   逻辑：如果你死了但被队友补枪，或者你补枪了队友，说明你们形成了交叉火力或同步走位。
    *   *扣分项*：**孤立死亡 (Isolation Death)** —— 死亡后 5秒内 无队友造成击杀，且 5秒前 无队友死亡。

### B. 道具管理 (Utility Management) - 权重 30%
衡量道具的使用效率与存活时的道具价值。
*   **指标：道具滞留惩罚 (Utility Retention Penalty)**
    *   逻辑：死亡时身上每剩余一颗道具扣除一定分数（烟雾弹/闪光弹权重更高）。
*   **指标：反向辅助 (Negative Assist)**
    *   逻辑：致盲队友的时间 / 致盲敌人时间的比例。如果致盲队友多于敌人，大幅扣分。

### C. 经济纪律 (Economy Discipline) - 权重 20%
衡量是否“毒瘤”起枪。
*   **指标：强起偏离度 (Force-buy Deviation)**
    *   逻辑：当全队平均装备价值 < $2000 (Eco局) 时，若个人装备价值 > $4000 (起大枪)，视为违背经济纪律（除特定翻盘战术外，长期如此视为低纪律）。

### D. 存活价值 (Survival Value) - 权重 10%
*   **指标：首死惩罚 (First Death Penalty)**
    *   逻辑：作为 CT 方，在回合早期（前 30秒）首死且未换掉对方任何一人（0换1），视为严重纪律问题。

## 3. 计算公式 (草案)

基础分：100分

$$
DI = 100 + (TradeScore) - (UtilityPenalty) - (EcoPenalty) - (MistakePenalty)
$$

1.  **TradeScore**: `(Trade Kills + Traded Deaths) * 2`
2.  **UtilityPenalty**: `(死亡剩余道具价值 / 100) * 0.5` + `(致盲队友时间 * 2)`
3.  **EcoPenalty**: `(违规强起次数 * 5)`
4.  **MistakePenalty**: `(CT白给首死次数 * 4)` + `(孤立死亡次数 * 2)`

## 4. 可行性分析 (基于现有 DemoParser)

| 指标 | 数据源要求 | 现有支持情况 | 实现难度 |
| :--- | :--- | :--- | :--- |
| 补枪判定 | `player_death` 事件的时间戳与位置(可选) | 支持 (通过时间差判定) | 低 |
| 剩余道具 | `player_death` 时的 `inventory` | **需确认** (Demo解析器通常包含死者掉落物) | 中 |
| 致盲队友 | `player_blind` 事件的 `attacker` 与 `victim` | 支持 | 低 |
| 经济装备 | `round_start` 或 `freeze_end` 时的装备价值 | 支持 | 低 |
| CT首死 | `round_start` 后首个 `player_death` | 支持 | 低 |

## 5. 下一步计划
1.  在 `PlayerMatchStats` 中增加 `discipline` 字段。
2.  在解析器中实现上述逻辑的追踪。
3.  在前端展示雷达图或评分。
